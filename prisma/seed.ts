/* eslint-disable @typescript-eslint/no-unused-vars */
// seed.ts
import { PrismaClient, DiscussionType, ReactionType } from '@prisma/client';

const prisma = new PrismaClient();

// Generate proper UUID v4 format strings for all entities
const UUIDS = {
  // Users
  users: {
    A: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11',
    B: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a12',
    C: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a13',
    D: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a14',
    E: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a15',
    F: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a16',
    G: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a17',
    H: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a18',
    I: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a19',
    J: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a20',
    K: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a21',
    L: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a22',
    M: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a23',
    N: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a24',
    O: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a25',
    P: 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a26',
  },
  // Courses
  courses: {
    course101: 'e0eebc99-9c0b-4ef8-bb6d-6bb9bd380e11',
    course303: 'e0eebc99-9c0b-4ef8-bb6d-6bb9bd380e12',
  },
  // Lessons
  lessons: {
    lesson202: 'f0eebc99-9c0b-4ef8-bb6d-6bb9bd380f11',
    lesson404: 'f0eebc99-9c0b-4ef8-bb6d-6bb9bd380f12',
  },
  // Threads
  threads: {
    courseReview: 'b0eebc99-9c0b-4ef8-bb6d-6bb9bd380b11',
    lessonDiscussion: 'b0eebc99-9c0b-4ef8-bb6d-6bb9bd380b12',
    singlePostReview: 'b0eebc99-9c0b-4ef8-bb6d-6bb9bd380b13',
    multiplePostsDiscussion: 'b0eebc99-9c0b-4ef8-bb6d-6bb9bd380b14',
  },
  // Posts
  posts: {
    post1: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c11',
    reply1: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c12',
    reply2: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c13',
    nestedReply: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c14',
    post2: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c15',
    lessonPost1: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c16',
    lessonReply1: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c17',
    lessonNestedReply: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c18',
    lessonReply2: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c19',
    singlePost: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c20',
    lessonPost2: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c21',
    lessonPost3: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c22',
    softDeletedPost: 'c0eebc99-9c0b-4ef8-bb6d-6bb9bd380c23',
  },
  // Reactions
  reactions: {
    like1: 'd0eebc99-9c0b-4ef8-bb6d-6bb9bd380d11',
    like2: 'd0eebc99-9c0b-4ef8-bb6d-6bb9bd380d12',
    love1: 'd0eebc99-9c0b-4ef8-bb6d-6bb9bd380d13',
    wow1: 'd0eebc99-9c0b-4ef8-bb6d-6bb9bd380d14',
    haha1: 'd0eebc99-9c0b-4ef8-bb6d-6bb9bd380d15',
    care1: 'd0eebc99-9c0b-4ef8-bb6d-6bb9bd380d16',
  },
} as const;

async function cleanup() {
  // Clean up existing data in reverse order of dependencies
  await prisma.reaction.deleteMany({});
  await prisma.post.deleteMany({});
  await prisma.thread.deleteMany({});

  console.log('üßπ Cleaned up existing data');
}

async function main() {
  // Clean up existing data first
  await cleanup();

  // =========================================================
  // Thread 1: Course Review v·ªõi nhi·ªÅu b√†i ƒëƒÉng v√† chu·ªói reply
  // =========================================================

  // T·∫°o thread ƒë√°nh gi√° kh√≥a h·ªçc
  const courseReviewThread = await prisma.thread.create({
    data: {
      id: UUIDS.threads.courseReview,
      type: DiscussionType.COURSE_REVIEW,
      courseId: UUIDS.courses.course101,
    },
  });

  // T·∫°o b√†i ƒëƒÉng ch√≠nh c√≥ rating
  const post1 = await prisma.post.create({
    data: {
      id: UUIDS.posts.post1,
      threadId: courseReviewThread.id,
      authorId: UUIDS.users.A,
      content:
        'Kh√≥a h·ªçc tuy·ªát v·ªùi! T√¥i r·∫•t th√≠ch phong c√°ch gi·∫£ng d·∫°y c·ªßa gi·∫£ng vi√™n.',
      rating: 5,
    },
  });

  // T·∫°o reply cho b√†i ƒëƒÉng ch√≠nh
  await prisma.post.create({
    data: {
      id: UUIDS.posts.reply1,
      threadId: courseReviewThread.id,
      parentId: post1.id,
      authorId: UUIDS.users.B,
      content: 'ƒê·ªìng √Ω! Gi·∫£ng vi√™n r·∫•t nhi·ªát huy·∫øt v√† d·ªÖ hi·ªÉu.',
    },
  });

  // T·∫°o reply th·ª© hai cho b√†i ƒëƒÉng ch√≠nh
  const reply2 = await prisma.post.create({
    data: {
      id: UUIDS.posts.reply2,
      threadId: courseReviewThread.id,
      parentId: post1.id,
      authorId: UUIDS.users.C,
      content: 'M√¨nh th·∫•y ph·∫ßn l√Ω thuy·∫øt h∆°i d√†i, c·∫ßn th√™m v√≠ d·ª• th·ª±c t·∫ø.',
    },
  });

  // T·∫°o nested reply cho reply2
  await prisma.post.create({
    data: {
      id: UUIDS.posts.nestedReply,
      threadId: courseReviewThread.id,
      parentId: reply2.id,
      authorId: UUIDS.users.A,
      content: 'C·∫£m ∆°n g√≥p √Ω, m√¨nh s·∫Ω chuy·ªÉn ƒë·∫øn ban t·ªï ch·ª©c.',
    },
  });

  // T·∫°o b√†i ƒëƒÉng th·ª© 2 (kh√¥ng reply)
  await prisma.post.create({
    data: {
      id: UUIDS.posts.post2,
      threadId: courseReviewThread.id,
      authorId: UUIDS.users.D,
      content: 'Kh√≥a h·ªçc hay nh∆∞ng t√†i li·ªáu c·∫ßn c·∫≠p nh·∫≠t th√™m.',
      rating: 4,
    },
  });

  // =========================================================
  // Thread 2: Lesson Discussion v·ªõi chu·ªói reply k√©o d√†i
  // =========================================================

  const lessonDiscussionThread = await prisma.thread.create({
    data: {
      id: UUIDS.threads.lessonDiscussion,
      type: DiscussionType.LESSON_DISCUSSION,
      lessonId: UUIDS.lessons.lesson202,
    },
  });

  // T·∫°o b√†i ƒëƒÉng ch√≠nh cho b√†i h·ªçc
  const lessonPost1 = await prisma.post.create({
    data: {
      id: UUIDS.posts.lessonPost1,
      threadId: lessonDiscussionThread.id,
      authorId: UUIDS.users.E,
      content:
        'B√†i h·ªçc n√†y kh√° kh√≥ hi·ªÉu, ƒë·∫∑c bi·ªát ph·∫ßn ƒë·ªá quy. C√≥ ai gi·∫£i th√≠ch th√™m kh√¥ng?',
    },
  });

  // T·∫°o reply cho b√†i ƒëƒÉng ch√≠nh
  const lessonReply1 = await prisma.post.create({
    data: {
      id: UUIDS.posts.lessonReply1,
      threadId: lessonDiscussionThread.id,
      parentId: lessonPost1.id,
      authorId: UUIDS.users.F,
      content: 'Th·ª≠ h√¨nh dung ƒë·ªá quy nh∆∞ l√† v√≤ng l·∫∑p, m·ªói l·∫ßn g·ªçi ch√≠nh n√≥.',
    },
  });

  // T·∫°o nested reply cho lessonReply1
  await prisma.post.create({
    data: {
      id: UUIDS.posts.lessonNestedReply,
      threadId: lessonDiscussionThread.id,
      parentId: lessonReply1.id,
      authorId: UUIDS.users.G,
      content: '√ù ki·∫øn hay, m√¨nh c≈©ng ƒë√£ h·ªçc theo c√°ch ƒë√≥ v√† th·∫•y hi·ªáu qu·∫£.',
    },
  });

  // T·∫°o th√™m reply cho b√†i ƒëƒÉng ch√≠nh
  await prisma.post.create({
    data: {
      id: UUIDS.posts.lessonReply2,
      threadId: lessonDiscussionThread.id,
      parentId: lessonPost1.id,
      authorId: UUIDS.users.H,
      content:
        'M√¨nh c√≥ m·ªôt video gi·∫£i th√≠ch r·∫•t chi ti·∫øt, c√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o!',
    },
  });

  // =========================================================
  // Thread 3: Course Review v·ªõi m·ªôt b√†i ƒëƒÉng ƒë∆°n gi·∫£n (kh√¥ng reply)
  // =========================================================

  const singlePostCourseReviewThread = await prisma.thread.create({
    data: {
      id: UUIDS.threads.singlePostReview,
      type: DiscussionType.COURSE_REVIEW,
      courseId: UUIDS.courses.course303,
    },
  });

  await prisma.post.create({
    data: {
      id: UUIDS.posts.singlePost,
      threadId: singlePostCourseReviewThread.id,
      authorId: UUIDS.users.I,
      content:
        'T√¥i kh√¥ng th√≠ch kh√≥a h·ªçc n√†y v√¨ qu√° l√Ω thuy·∫øt v√† thi·∫øu th·ª±c h√†nh.',
      rating: 2,
    },
  });

  // =========================================================
  // Thread 4: Lesson Discussion v·ªõi nhi·ªÅu b√†i ƒëƒÉng ƒë·ªôc l·∫≠p
  // =========================================================

  const multiplePostsLessonDiscussionThread = await prisma.thread.create({
    data: {
      id: UUIDS.threads.multiplePostsDiscussion,
      type: DiscussionType.LESSON_DISCUSSION,
      lessonId: UUIDS.lessons.lesson404,
    },
  });

  const lessonPost2 = await prisma.post.create({
    data: {
      id: UUIDS.posts.lessonPost2,
      threadId: multiplePostsLessonDiscussionThread.id,
      authorId: UUIDS.users.J,
      content: 'B√†i h·ªçc n√†y r·∫•t r√µ r√†ng, m√¨nh hi·ªÉu ngay l·∫≠p t·ª©c.',
    },
  });

  const lessonPost3 = await prisma.post.create({
    data: {
      id: UUIDS.posts.lessonPost3,
      threadId: multiplePostsLessonDiscussionThread.id,
      authorId: UUIDS.users.K,
      content:
        'M√¨nh c√≥ ch√∫t bƒÉn khoƒÉn ·ªü ph·∫ßn k·∫øt th√∫c, ai c√≥ th·ªÉ gi·∫£i th√≠ch th√™m kh√¥ng?',
    },
  });

  // =========================================================
  // T·∫°o Reaction cho c√°c b√†i ƒëƒÉng
  // =========================================================

  // Reactions cho b√†i ƒëƒÉng ch√≠nh c·ªßa Thread 1
  await prisma.reaction.create({
    data: {
      id: UUIDS.reactions.like1,
      postId: post1.id,
      userId: UUIDS.users.L,
      type: ReactionType.LIKE,
    },
  });
  await prisma.reaction.create({
    data: {
      id: UUIDS.reactions.love1,
      postId: post1.id,
      userId: UUIDS.users.M,
      type: ReactionType.LOVE,
    },
  });
  await prisma.reaction.create({
    data: {
      id: UUIDS.reactions.care1,
      postId: post1.id,
      userId: UUIDS.users.N,
      type: ReactionType.CARE,
    },
  });

  // Reaction cho b√†i ƒëƒÉng ch√≠nh c·ªßa Thread 2
  await prisma.reaction.create({
    data: {
      id: UUIDS.reactions.wow1,
      postId: lessonPost1.id,
      userId: UUIDS.users.O,
      type: ReactionType.WOW,
    },
  });

  // Reactions cho t·ª´ng b√†i ƒëƒÉng c·ªßa Thread 4
  await prisma.reaction.create({
    data: {
      id: UUIDS.reactions.like2,
      postId: lessonPost2.id,
      userId: UUIDS.users.J,
      type: ReactionType.LIKE,
    },
  });
  await prisma.reaction.create({
    data: {
      id: UUIDS.reactions.haha1,
      postId: lessonPost3.id,
      userId: UUIDS.users.K,
      type: ReactionType.HAHA,
    },
  });

  // =========================================================
  // V√≠ d·ª• v·ªÅ soft delete: t·∫°o m·ªôt post r·ªìi soft delete
  // =========================================================

  await prisma.post.create({
    data: {
      id: UUIDS.posts.softDeletedPost,
      threadId: courseReviewThread.id,
      authorId: UUIDS.users.P,
      content: 'B√†i ƒëƒÉng n√†y s·∫Ω ƒë∆∞·ª£c soft delete.',
      rating: 3,
      deletedAt: new Date(), // Soft delete ngay khi t·∫°o
    },
  });

  console.log('‚úÖ ƒê√£ t·∫°o d·ªØ li·ªáu m·∫´u ƒëa d·∫°ng cho microservice th√†nh c√¥ng!');
  // Log m·ªôt s·ªë UUID ƒë·ªÉ tham kh·∫£o sau n√†y
  console.log('üîë Sample UUIDs for reference:');
  console.log('Thread 1:', UUIDS.threads.courseReview);
  console.log('Post 1:', UUIDS.posts.post1);
  console.log('User A:', UUIDS.users.A);
}

main()
  .catch((e) => {
    console.error('‚ùå L·ªói khi seed d·ªØ li·ªáu:', e);
    process.exit(1);
  })
  // eslint-disable-next-line @typescript-eslint/no-misused-promises
  .finally(async () => {
    await prisma.$disconnect();
  });
